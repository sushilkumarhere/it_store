<!DOCTYPE html>
{% extends "base.html" %}
{% load static %}
{% load widget_tweaks %}

<html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>System Details</title>
        </head>
  <body>
    {% block content %}
       <div class="container">
                    <div class="section-header text-center">
                      <h2 class="section-title wow fadeInDown" data-wow-delay="0.3s">IT Systems Details</h2>
                      <div class="shape wow fadeInDown" data-wow-delay="0.3s"></div>
                    </div>
                <!-- Search form -->
           <form method="get" id="ItemSearch" data-cities-url="{% url 'ajax_load_ItemModel' %}" >
               {% csrf_token %}
                    <div class="well">
                      <div class="row">
                        <div class="form-group col">
                          {{ filter.form.item_name.label_tag }}
                          {% render_field filter.form.item_name class="form-control" %}
                        </div>
                        <div class="form-group col">
                          {{ filter.form.item_model.label_tag }}
                          {% render_field filter.form.item_model class="form-control" %}
                        </div>
                        <div class="form-group col">
                          {{ filter.form.acblock.label_tag }}
                          {% render_field filter.form.acblock class="form-control" %}
                        </div>
                        <div class="form-group col">
                          {{ filter.form.inst.label_tag }}
                          {% render_field filter.form.inst class="form-control" %}
                        </div>
                        <div class="form-group col">
                          {{ filter.form.room_type.label_tag }}
                          {% render_field filter.form.room_type class="form-control" %}
                        </div>
                         <div class="form-group col">
                             <h5>Search</h5>
                             <button type="submit" class="btn btn-success" >Search</button>
                            
                            <a href="{% url 'export_xls_issue' %}"></i>Excel
                              <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-file-earmark-spreadsheet" viewBox="0 0 16 16">
                                <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V9H3V2a1 1 0 0 1 1-1h5.5v2zM3 12v-2h2v2H3zm0 1h2v2H4a1 1 0 0 1-1-1v-1zm3 2v-2h3v2H6zm4 0v-2h3v1a1 1 0 0 1-1 1h-2zm3-3h-3v-2h3v2zm-7 0v-2h3v2H6z"/>
                              </svg>
                            </a>


                             
                         </div>
                      </div>
                    </div>
           </form>
                  <div class="card">
                       <div class="table-responsive">
                           <table class="table">
                                            <thead>
                                                  <tr>
                                                    <th scope="col">Item Name</th>
                                                    <th scope="col">Model No[Spec]</th>
                                                    <th scope="col">Block[room no]/Type</th>
                                                    <th scope="col">Department/User </th>                                              
                                                    <th scope="col">Quantity</th>
                                                    <th scope="col">Purchase Dt </th>
                                                    <th scope="col">updated_on</th>
                                                  </tr>
                                            </thead>
                                        <tbody>
                                           {% for itm in filter.qs %}
                                          <tr>
                                            <td>{{ itm.item_name }}</td>
                                            <td>{{ itm.item_model }} <p class="text-primary"> [{{ itm.item_configuration }}]</p></td>
                                            <td>{{ itm.acblock }} [{{ itm.room }}] : {{ itm.room_type }}</td>
                                            <td>{{ itm.inst }}<p class="text-primary">{{ itm.user }}</p></td>                                            
                                            <td>{{ itm.item_qty }}</td>
                                            <td>{{ itm.purchase_date }}</td>
                                            <td>{{ itm.updated_at }}</td>
                                          </tr>
                                            {% endfor  %}
                                        </tbody>
                           </table>
                       </div>
                  </div>
                            <div class="card" style="width: 12rem;">
                              
                                <h5 class="card-title">Total Quantity :  {{ totality.item_qty__sum }}</h5>
                           
                            </div>

       </div>

        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
              <script>
                $("#id_item_name").change(function () {
                  var url = $("#ItemSearch").attr("data-cities-url");
                  var itemId = $(this).val();
                  $.ajax({
                    url: url,
                    data: {
                      'item_name': itemId
                    },
                    success: function (data) {
                      $("#id_item_model").html(data);
                    }
                  });

                });
            </script>

    {% endblock content %}
  </body>
</html>